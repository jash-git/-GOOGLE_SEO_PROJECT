<html>
  <head>
    <title>Read File (via User Input selection)</title>
    <script type="text/javascript">
    var reader; //GLOBAL File Reader object for demo purpose only
	var NewArray = new Array();
		var count=-1;
		function jumpto_0(inputurl)
		{
			//alert(inputurl);
			var el = document.getElementById('main'); 
			var str='';
			str=''+count;
			str=str+';';
			str=str+inputurl;
			el.innerHTML = str; //display output in DOM
			
			if (document.getElementById&&displaymode==0)
				document.getElementById("external_0").src=inputurl
			else if (document.all&&displaymode==0)
				document.all.external_0.src=inputurl
			else
			{
				if (!window.win2||win2.closed)
					win2=window.open(inputurl)
				else
				{
					win2.location=inputurl
					win2.focus()
				}
			}
		}
		function jumpto_1(inputurl)
		{
			//alert(inputurl);
			var el = document.getElementById('main'); 
			var str='';
			str=''+count;
			str=str+';';
			str=str+inputurl;
			el.innerHTML = str; //display output in DOM
			
			if (document.getElementById&&displaymode==0)
				document.getElementById("external_1").src=inputurl
			else if (document.all&&displaymode==0)
				document.all.external_1.src=inputurl
			else
			{
				if (!window.win2||win2.closed)
					win2=window.open(inputurl)
				else
				{
					win2.location=inputurl
					win2.focus()
				}
			}
		}
		function jumpto_2(inputurl)
		{
			//alert(inputurl);
			var el = document.getElementById('main'); 
			var str='';
			str=''+count;
			str=str+';';
			str=str+inputurl;
			el.innerHTML = str; //display output in DOM
			
			if (document.getElementById&&displaymode==0)
				document.getElementById("external_2").src=inputurl
			else if (document.all&&displaymode==0)
				document.all.external_2.src=inputurl
			else
			{
				if (!window.win2||win2.closed)
					win2=window.open(inputurl)
				else
				{
					win2.location=inputurl
					win2.focus()
				}
			}
		}
		function jumpto_3(inputurl)
		{
			//alert(inputurl);
			var el = document.getElementById('main'); 
			var str='';
			str=''+count;
			str=str+';';
			str=str+inputurl;
			el.innerHTML = str; //display output in DOM
			
			if (document.getElementById&&displaymode==0)
				document.getElementById("external_3").src=inputurl
			else if (document.all&&displaymode==0)
				document.all.external_3.src=inputurl
			else
			{
				if (!window.win2||win2.closed)
					win2=window.open(inputurl)
				else
				{
					win2.location=inputurl
					win2.focus()
				}
			}
		}			
		function Run()
		{
			/*
			count++;
			if(count>=NewArray.length)
			{
				count=0;
			}
			*/
			var maxNum = NewArray.length;  
			var minNum = 0;  
			var n = Math.floor(Math.random() * (maxNum - minNum + 1)) + minNum;
			count=n;
			jumpto_1(NewArray[count]);
			
			var maxNum = NewArray.length;  
			var minNum = 0;  
			var n = Math.floor(Math.random() * (maxNum - minNum + 1)) + minNum;
			count=n;			
			jumpto_2(NewArray[count]);
			
			var maxNum = NewArray.length;  
			var minNum = 0;  
			var n = Math.floor(Math.random() * (maxNum - minNum + 1)) + minNum;
			count=n;			
			jumpto_3(NewArray[count]);
			
			var maxNum = NewArray.length;  
			var minNum = 0;  
			var n = Math.floor(Math.random() * (maxNum - minNum + 1)) + minNum;
			count=n;			
			jumpto_0(NewArray[count]);
			
			setTimeout("Run();", 90000);
		}	
    /**
     * Check for the various File API support.
     */
    function checkFileAPI() {
        if (window.File && window.FileReader && window.FileList && window.Blob) {
            reader = new FileReader();
            return true; 
        } else {
            alert('The File APIs are not fully supported by your browser. Fallback required.');
            return false;
        }
    }

    /**
     * read text input
     */
    function readText(filePath) {
        var output = ""; //placeholder for text output
        if(filePath.files && filePath.files[0]) {           
            reader.onload = function (e) {
                output = e.target.result;
                displayContents(output);
            };//end onload()
            reader.readAsText(filePath.files[0]);
        }//end if html5 filelist support
        else if(ActiveXObject && filePath) { //fallback to IE 6-8 support via ActiveX
            try {
                reader = new ActiveXObject("Scripting.FileSystemObject");
                var file = reader.OpenTextFile(filePath, 1); //ActiveX File Object
                output = file.ReadAll(); //text contents of file
                file.Close(); //close file "input stream"
                displayContents(output);
            } catch (e) {
                if (e.number == -2146827859) {
                    alert('Unable to access local files due to browser security settings. ' + 
                     'To overcome this, go to Tools->Internet Options->Security->Custom Level. ' + 
                     'Find the setting for "Initialize and script ActiveX controls not marked as safe" and change it to "Enable" or "Prompt"'); 
                }
            }       
        }
        else { //this is where you could fallback to Java Applet, Flash or similar
            return false;
        }       
        return true;
    }   

    /**
     * display content using a basic HTML replacement
     */
    function displayContents(txt) {

		var show='';
		NewArray=txt.split(";");
		for (i = 0; i < NewArray.length; i++) { 
			show += NewArray[i] + "<br>";
		}
		alert(show);
		
		Run();
    }
	function Timer()
	{
		setTimeout("Run();", 1000);
	}
	
</script>
</head>
<body onload="checkFileAPI();">
    <div id="container">    
        <input type="file" onchange='readText(this)' />
        <br/>
        <hr/>   
        <div id="main">
            ...
        </div>
		<script language="javascript">
			<!--
			var displaymode=0
			var iframecode0='<iframe id="external_0" style="width:100%;height:25%" src="http://crazed-it.frog.tw/"></iframe>'
			var iframecode1='<iframe id="external_1" style="width:100%;height:25%" src="http://crazed-it.frog.tw/"></iframe>'
			var iframecode2='<iframe id="external_2" style="width:100%;height:25%" src="http://crazed-it.frog.tw/"></iframe>'
			var iframecode3='<iframe id="external_3" style="width:100%;height:25%" src="http://crazed-it.frog.tw/"></iframe>'
			if (displaymode==0)
			{
				document.write(iframecode0)
				document.write(iframecode1)
				document.write(iframecode2)
				document.write(iframecode3)
			}
			//-->
		</script>
    </div>
	
</body>
</html>